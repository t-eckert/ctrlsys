# Shared Library Tasks

version: '3'

vars:
  LIB_NAME: ctrlsys-lib

tasks:
  # Build tasks
  build:
    desc: "ğŸ—ï¸ Build shared library"
    cmds:
      - cargo build

  build:release:
    desc: "ğŸ—ï¸ Build shared library (release)"
    cmds:
      - cargo build --release

  # Test tasks
  test:
    desc: "ğŸ§ª Run library tests"
    cmds:
      - cargo test

  test:doc:
    desc: "ğŸ§ª Run documentation tests"
    cmds:
      - cargo test --doc

  # Code quality
  fmt:
    desc: "ğŸ¨ Format library code"
    cmds:
      - cargo fmt

  clippy:
    desc: "ğŸ” Run clippy on library"
    cmds:
      - cargo clippy -- -D warnings

  check:
    desc: "âœ… Check library (fmt + clippy + test)"
    cmds:
      - task: fmt
      - task: clippy
      - task: test

  # Documentation
  docs:
    desc: "ğŸ“š Generate and open documentation"
    cmds:
      - cargo doc --open --no-deps

  docs:build:
    desc: "ğŸ“š Build documentation"
    cmds:
      - cargo doc --no-deps

  # Development
  watch:
    desc: "ğŸ‘€ Watch and rebuild library"
    cmds:
      - cargo watch -x build

  watch:test:
    desc: "ğŸ‘€ Watch and test library"
    cmds:
      - cargo watch -x test

  watch:doc:
    desc: "ğŸ‘€ Watch and build docs"
    cmds:
      - cargo watch -x "doc --no-deps"

  # Benchmarks
  bench:
    desc: "âš¡ Run benchmarks"
    cmds:
      - cargo bench

  # Examples
  examples:
    desc: "ğŸ“ Run all examples"
    cmds:
      - cargo run --example basic
      - cargo run --example advanced

  example:
    desc: "ğŸ“ Run specific example"
    cmds:
      - cargo run --example {{.EXAMPLE}}

  # Publishing (if this becomes a public crate)
  publish:dry:
    desc: "ğŸ“¦ Dry run publish"
    cmds:
      - cargo publish --dry-run

  publish:
    desc: "ğŸ“¦ Publish to crates.io"
    cmds:
      - cargo publish

  # Cleanup
  clean:
    desc: "ğŸ§¹ Clean library build artifacts"
    cmds:
      - cargo clean
      - rm -rf target/

  # Development shortcuts
  dev:
    desc: "ğŸš€ Quick development cycle"
    cmds:
      - task: check
      - task: docs:build